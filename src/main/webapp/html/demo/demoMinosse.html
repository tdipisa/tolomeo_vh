<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
	"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="it">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="description" content="Descrizione diversa dal titolo" />
<meta name="keywords" content="elenco parole chiave separate da virgola" />
<title>Tolomeo - Pagina Demo</title>

<!-- CSS -->
<link rel="stylesheet" type="text/css" href="http://tolomeo.comune.prato.it/js/ext/extJS/resources/css/ext-all.css" />
<link rel="stylesheet" type="text/css" href="http://tolomeo.comune.prato.it/js/ext/extJS/resources/extTheme/olive/css/xtheme-olive.css" />
<link rel="stylesheet" type="text/css" href="http://tolomeo.comune.prato.it/css/toloExt-intra.css" />

<!-- js build (solo per sviluppo) -->
<script type="text/JavaScript" src="http://dvptolomeo.comune.prato.it/js/tolomeoExt/build/toloExt-all.js" charset="utf-8"></script>
<script type="text/JavaScript" src="http://dvptolomeo.comune.prato.it/tolomeobinj/ToloExtParamsJSServlet?paramPreset=Stradario" charset="utf-8"></script>
<script type="text/JavaScript" src="/tolomeohtdocs/js/tolomeoExt/layout/ToloPanelIntra.js" charset="utf-8"></script>
<script type="text/JavaScript" src="/tolomeohtdocs/js/tolomeoExt/Minosse.js" charset="utf-8"></script>


<script type="text/JavaScript">

	
Ext.onReady(function(){
	tolomeo = new TolomeoExt.ToloPanelIntra({
		withDataPanel: false,
		withToolsPanel: false,
		toolbarOpt: {
			withSeleziona: false,
			withAnnullaSeleziona: false,
			withLayerList:  false,
			withIdentify:  false,
			withNuovo:  false,
			withUpdateAlfa:  false,
			withAdd:  false,
			withSubtract:  false,
			withAddSub:  false,
			withVertexEdit:  false,
			withDragDrop:  false,
			withDelete:  false,
			withAutoIdentify: false
		}
	});

	var toloPnl = new Ext.Panel({
		autoWidth: true,
		monitorResize: true,
		height: 600,
		width: 600,
		layout: 'fit',
		renderTo: 'sit_mappa',
		items: [tolomeo]
	});
	
	
	
	Ext.Minosse.KeepAlive.init({
		wakeupResource : "/html/demo/demoMinosseAccessController.html", 
		wsTimeout : 1 ,
		forceNoCache: false 
	});
	
	//Ext.Ajax.on('beforerequest', function(){Ext.Msg.alert('attenzione','beforerequest');}, this);
	
		
});	

function callAllRequest(){

	Ext.Ajax.request({
		url:'/img/stemma.jpg',
		method:'POST',
		callback: function(o,s){
			if(!s){
				//Ext.Msg.alert('attenzione','ahi ahi');
				document.title += " C1:NOK ";				
			}else{
				document.title += " C1:OK ";
			}
		}
	});

/*
	Ext.Ajax.request({
		url:'/img/stemma.jpg',
		method:'POST',
		callback: function(o,s){
			if(!s){
				//Ext.Msg.alert('attenzione','ahi ahi');
				document.title += " C1:NOK ";				
			}else{
				document.title += " C1:OK ";
			}
		}
	});
	
	
	Ext.Ajax.request({
		url:'www.casaross.it',
		method:'POST',
		callback: function(o,s){
			if(!s){
				//Ext.Msg.alert('attenzione','ahi ahi');
				document.title += " C2:NOK ";				
			}else{
				document.title += " C2:OK ";
			}			
		}
	});
	Ext.Ajax.request({
		url:'www.casaross.it',
		method:'POST',
		callback: function(o,s){
			if(!s){
				//Ext.Msg.alert('attenzione','ahi ahi');
				document.title += " C3:NOK ";				
			}else{
				document.title += " C3:OK ";
			}			
		}
	});
	*/
}
/*
Ext.util.Cookies.expire = function(name, path){
	if(Ext.util.Cookies.get(name)){
		document.cookie = name + "=" + "; expires=Thu, 01-Jan-70 00:00:01 GMT; path=" + (path?path:"/");
	}
};
	
	
var wsTimeout = 4;
		
function checkMinosseTimeout(scope,config){

	if(checkMinosseTimeout.busy){
		return false;
	}

	var lastRequest = Ext.util.Cookies.get("lastRequest");
	var now = new Date().getTime();
	
	if(!lastRequest || ((now - lastRequest) > (wsTimeout * 1000))) {
		
		checkMinosseTimeout.busy = true;
		
		document.title += 'espirato';
		Ext.util.Cookies.set('lastRequest',now);
		Ext.util.Cookies.expire('wscookie');
		
		//Ext.fly('minosse').dom.onload = function(){alert(this.contentWindow.document.body.innerHTML);Ext.Ajax.request(config);};
		//Ext.fly('minosse').dom.onload = function(){alert(this.contentDocument.body.innerHTML);Ext.Ajax.request(config);};
		
		var ex = function(config) {
			checkMinosseTimeout.busy = false; 
			Ext.Msg.alert('eseguo');
			Ext.Ajax.request(config);			
		};
		
		if(Ext.isIE){
			Ext.fly('minosse').dom.onreadystatechange = function(){
				if(this.readyState == 'complete'){ 
					ex(config);
				}
			};		
		}else{
			Ext.fly('minosse').dom.onload = function(){
				ex(config);
			};
		}
		
		Ext.fly('minosse').dom.src = "/img/stemma.jpg";
		
		return false;		
	} else {
		
	    document.title += ' -> eseguo';
		Ext.util.Cookies.set('lastRequest',now);
		return true;
	}
}
*/	

</script>
</head>

<body>
	<div id="tmpl_header">
		<div id="tmpl_headerwrap">
			<div id="tmpl_procedura">
				<span id="tmpl_procedura_jmpmn"><a href="#tmpl_menu" title="salta al menù della procedura" accesskey="8">Salta al menù</a></span>
				<span id="tmpl_procedura_jmpcntnt"><a href="#content" title="salta al contenuto della procedura" accesskey="0">Salta al contenuto</a></span>
				<span id="tmpl_procedura_titolo">Tolomeo Ext</span>
				<h1 id="sit_procedura_sottotitolo"></h1>
			</div>
		</div>	
		
		<div id="tmpl_utenza">
			<span id="tmpl_utenza_nome"></span>
			<span id="tmpl_utenza_data"></span>
		</div>
	</div>
	<!-- Fine Intestazione/header -->
	
	<!-- Logout/Percorso -->
	<div id="tmpl_barra">
		<div id="tmpl_barrawrap"> 
			<div id="tmpl_percorso">
				<ol title="Percorso di navigazione dalla home page">
					<li><a href="#">home</a></li>
					<li></li>
				</ol>
			</div>
		</div>
		<div id="tmpl_logout"><a href="javascript:window.close();">logout</a></div>
	</div>
	<!-- Fine Logout/Percorso -->
	
	<!-- Menu/Content -->
	<div id="tmpl_main">
		<!-- Content -->
		<div id="tmpl_mainwrap">		
			<div id="tmpl_content">
	
				<h1>Demo MINOSSE</h1>
				
				<div id="sit_mappa" class="clearCSS"></div>
			</div>
		</div>
	</div>
		
	<!-- Copyright -->
	<div id="tmpl_footer">
		<div class="minibutton validator" title="CSS valido">W3C <span>CSS 3</span></div>
		<div class="minibutton validator" title="XHTML valido">W3C <span>XHTML 1.0</span></div>
		<div class="minibutton comune" title="Copyright Comune di Prato, tutti i diritti riservati">copyright <span>Comune di Prato</span></div>
	</div>
	<!-- Fine Copyright -->
</body>
</html>